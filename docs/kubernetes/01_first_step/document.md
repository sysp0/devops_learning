# ุฏูพูู ฺฉุฑุฏู ุงููู ุงูพูฺฉุดู ุจุฑ ุฑู ฺฉูุจุฑูุชุฒ
## ููุฏูู ู ูุฏู
ูุฏู ุงู ุฏุงฺฉูููุช ูพุงุฏู ุณุงุฒ ฺฉ ุงูพูฺฉุดู ุณุงุฏู ุจุฑ ุฑู ฺฉูุจุฑูุชุฒ ุงุณุช. ุฏุฑ ุงู ุฏุงฺฉูููุช ฺฉ ุจุฑูุงูู flask ุจุง ุฒุจุงู ูพุงุชูู ูููุณู ู ุณุน ูฺฉูู ุจุง ุฏุงฺฉุฑ ุงู ุฑู ุชุจุฏู ุจู ฺฉ image ุจฺฉูู ู ุฑู registry ูุฑุงุฑ ุฏูู ฺฉู ุงุฒ ุทุฑู ฺฉูุจุฑูุชุฒ ุงูู ุฑู ุฏูพูู ฺฉูู. 
## ุฏุงฺฉุฑุงุฒ ฺฉุฑุฏู ุงูพูฺฉุดู
ฺฉ ุจุฑูุงูู ุณุงุฏู Flask ุฏุงุฑู:
```python
# app.py
from flask import Flask
import socket

app = Flask(__name__)

@app.route('/')
def show_hostname():
    pod_name = socket.gethostname()
    return f"""
    <html>
        <body style="font-family: Arial; text-align: center; padding: 50px;">
            <h1>Hello from Kubernetes! ๐</h1>
            <p>This app is running inside Pod:</p>
            <h2 style="color: blue;">{pod_name}</h2>
            <p>Feel free to visit again to see this in action!</p>
        </body>
    </html>
    """

@app.route('/health')
def health():
    return {'status': 'healthy'}, 200

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
```

ุงู ุจุฑูุงูู ฺฉ html ุฎุฑูุฌ ูุฏูุฏ ฺฉู hostname ุฑู ููุงุด ูุฏูุฏ.

ุญุงูุง ุจุงุฏ ุจุฑุง ุงู ุจุฑูุงูู Dockerfile ุงุถุงูู ฺฉูู:

ฺฉ ุฏุงฺฉุฑ ูุงู ุจุณุงุฑ ุณุงุฏู ูููุณู ฺฉู ุจุชููู ุงู ุงูพูฺฉุดู ุฑู ุฏุงฺฉุฑุงุฒ ฺฉูู.

```Dockerfile
FROM python:3.11-slim
WORKDIR /app
RUN pip install --no-cache-dir Flask==3.0.0
COPY main.py .
EXPOSE 5000
CMD ["python", "main.py"]
```

ุญุงูุง ุจุงุฏ ุจุฑูุงูู ููู ุฑู build ุจฺฏุฑู ุจุง ุฏุณุชูุฑ ุฒุฑ:
```bash
โ docker build -t hello_app:latest .
```

ุจุนุฏ ุงุฒ ุงู ูุฑุญูู ุญุงูุง ูุง ฺฉ ุงูพูฺฉุดู ุฏุงุฑู ฺฉู ูุชููู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑ kubectl ุงู ุงูพ ุฑู ุจุฑ ุฑู ฺฉูุจุฑูุชุฒ ุฏูพูู ฺฉูู.

ูฺฉุชู :
ุจุฑุง ุงูฺฉู ุจุชููู ฺฉูุจุฑูุชุฒ ุงูุฌ ูุงุฑู ุฏุงุดุชู ุจุงุดู ฒ ุฑุงู ุฏุงุฑู:
ฑ. ุงูฺฉู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉูู ฺฉู ุงูุฌ ุฑู ุฏุงุฎู ุฑุฌุณุชุฑ ุฏุงฺฉุฑ ุงุถุงูู ฺฉูู:
```
โ docker tag hello_app:latest {registry username}/hello_app:latest
โ docker push {registry username}/hello_app:latest
```

ฒ. ุง ุงูฺฉู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงูุฌ ุฑู ุจู minikube ุงุถุงูู ฺฉูู:
```bash
โ minikube image load hello_app:latest
```
ุจุง ุงู ฺฉุงุฑ ุญุงูุง ูุชูุงูู ุงูพูฺฉุดู ููุฑุฏ ูุธุฑููู ุฑู ุฏูพูู ฺฉูู.

## ุฏูพูู ฺฉุฑุฏู ุงูพูฺฉุดู
ุญุงูุง ฺฉู ุงูุฌ ููุฑุฏ ูุธุฑููู ุณุงุฎุชู ุดุฏ ุญุงูุง ูุง ูุชูุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ kubectl ุจู ฺฉูุจุฑูุชุฒ ุจูููููู ุงูพูฺฉุดู ูุง ฺ ูุณุชุด ู ฺู ุณุงุฎุชุงุฑ ุจุฑุง ุฏูพูู ุฏุงุฑุฏ.

ูุง ุจุฑุง ุดุฑูุน ูุชููู ุฏูพูู ุฑู ุฎู ุณุงุฏู ุจุจูู ุจุตูุฑุช ฺฉู ุจู ฺฉูุจุฑูุชุฒ ุจฺฏู ูู ููุท ฺฉ ุงูพูฺฉุดู ุฏุงุฑูุุงู ุงูพ ูู ฺู ูพูุฑุช ุฏุงุฑู ู ููุท ุงุฒุด ฺฉ ุฏููู ุจุณุงุฒ ุญุช ุงฺฏุฑ ูพุงู ุงููุฏ ุชู ุฏฺฏ ุจุงูุง ูุงุฑุดุ ุจุง ุฏุณุชูุฑ ุฒุฑ ุงู ุฑู ุจู ฺฉูุจุฑูุชุฒ ูฺฏู:
### ุณุงุฎุช pod

```bash
โ kubectl run api --image=hello_app:latest --port=5000 --restart=Never
```
ูฺฉุชู :
ุงู ุญุงูุช ููุท ุจุฑุง ุชุณุช ุงุณุชูุงุฏู ูุดูุฏ ู ุชู ูุญุท ูุงูุน ูุง ุงุฒ ููููู ุจู ูุงู Deployment ุงุณุชูุงุฏู ูฺฉูู ฺฉู ูุงุจูุช ูุง ุจุดุชุฑ ุงุฒ ุงู ุญุงูุช ูุฏูุฏ ฺฉู ุฌููุชุฑ ุจุฑุฑุณ ูฺฉูู. 
ูุฒุงุง ุงู ุญุงูุช: 
- ฺฉ **Pod** ูุณุชูู ุงุฌุงุฏ ูโฺฉูุฏ
- ุขูพุดู`--restart=Never` ุนู ุงฺฏุฑ Pod ุฎุฑุงุจ ุดูุฏุ ุฏูุจุงุฑู ุฑุงูโุงูุฏุงุฒ ููโุดูุฏ
- ููุงุณุจ ุจุฑุง ุชุณุชโูุง ูููุช ุง ุงุฌุฑุง ฺฉุจุงุฑ ูุตุฑู
- ูุฏุฑุช ู scale ฺฉุฑุฏู ูุฏุงุฑุฏ
- ุงฺฏุฑ Pod ุญุฐู ุดูุฏุ ุฏฺฏุฑ ุจุงุฒููโฺฏุฑุฏุฏ


ุจุฑุง ุจุฑูุงูู ููู ฺฉ ุงุณู ุงูุชุฎุงุจ ูฺฉูู `api` ู ุงูุฌ ููุฑุฏ ูุธุฑููู ุฑู ูุดุฎุต ูฺฉูู `hello_app:latest` ู ุงูฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ `port--` ูุดุฎุต ูฺฉูู ุจุฑูุงูู ููู ุฑู ฺู ูพูุฑุช ฺฏูุด ูุฏูุฏ ุงู ุชูุธู ูฺ ูพูุฑุช ุฑู ุจุงุฒ ููฺฉูุฏ ู ููุท ฺฉ ูุชุงุฏุชุง ุณุงุฏู ูุณุชุด ุจุฑุง ุฏุณุชุฑุณ ุจู ุงูพูฺฉุดู ููู ุจุงุฏ `service` ุชุนุฑู ฺฉูู ฺฉู ุฏุฑ ุฌููุชุฑ ุงู ุฑู ุงูุฌุงู ูุฏู.

ุญุงูุง ุจุง ุฏุณุชูุฑ ุฒุฑ ูุชููู ุจุจูู ูุถุนุช pod ูุงููู ุชู ฺู ูุถุนุช ูุณุชูุฏ:
```bash
NAME                   READY   STATUS    RESTARTS        AGE
api                    1/1     Running   0               12m
```
ุงฺฏุฑ ุญุงูุช ุจุงูุง ุฑู ุจุจูุฏ ุนู ุนููุงุช ุจุง ููููุช ุงูุฌุงู ุดุฏู. ุงฺฏุฑ `STATUS` ุจุฑุงุจุฑ ุจูุฏุด ุจุง `ErrImagePull` ุนู ุนููุงุช pull ฺฉุฑุฏู ุจุง ูุดฺฉู ููุงุฌู ุดุฏู :
```
NAME                   READY   STATUS         RESTARTS        AGE
wrong                  0/1     ErrImagePull   0               6s
```
ุญุงูุง ุจุฑุง ุฏุฏู ูุงฺฏ pod ููุฑุฏ ูุธุฑููู ูุชููู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉูู:
```bash
โ kubectl logs wrong                                                             
Error from server (BadRequest): container "wrong" in pod "wrong" is waiting to start: trying and failing to pull image
```
ูููุทูุฑ ฺฉู ูุจูุฏ ุชูุถุญ ูุฏูุฏ ุนููุงุช pull image ุจู ูุดฺฉู ุฎูุฑุฏู ุงุณุช.

ุชุง ุงูุฌุง ูุง ุชููุณุชู pod ููุฑุฏ ูุธุฑููู ุฑู ุจุงูุง ุจุงุฑู ุญุงูุง ููุช ุงู ูุณุช ฺฉู ุจุชููู ุจูุด ุฏุณุชุฑุณ ุจฺฏุฑู. 

### ุณุงุฎุช service
ูุง ุจุฑุง ุงูฺฉู ุจุชููู ุจู pod ูุง ููุฑุฏ ูุธุฑููู ุฏุณุชุฑุณ ุจฺฏุฑู ุจุงุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ service ุฏุณุชุฑุณ ููุฑุฏ ูุธุฑููู ุฑู ุชุนุฑู ฺฉูู.

ุจุฑุง ุงูฺฉู ุฏุณุชุฑุณ ุจู ุงุฌุฒุง ฺฉูุจุฑูุชุฒ ูพุฏุง ฺฉูู ุจุงุฏ ุงุฒ ุฏุณุชูุฑ `kubectl expose` ุงุณุชูุงุฏู ฺฉูู ฺฉู ูุฎุตูุต ุณุงุฎุช ุณุฑูุณ ูุณุช ฺฉู ฺฉ ููุจุน ฺฉูุจุฑูุชุฒ (ูุซู Podุ Deploymentุ ReplicaSet) ุฑุง ุฏุฑ ูุนุฑุถ ุฏุณุชุฑุณ ูุฑุงุฑ ูโุฏูุฏ.

ูุง ฺูุฏู ุญุงูุช ุณุฑูุณ ูุชููู ุฏุงุดุชู ุจุงุดู ูู ุญุงูุช ฺฉู ุงูุฌุง ุงุณุชูุงุฏู ูฺฉูู `NodePort` ูุณุชุด ฺฉู ุฎู ุณุงุฏู ูุณุช ุจุฑุง ููุช ฺฉู ูุง ููุท ุจุตูุฑุช ุชุณุช ฺฉ Pod ุฑู ุจุตูุฑุช ุฏุณุช ุงูุฑุฏู ุจุงูุง ุจุฑุง ุชุณุช.

ุญุงูุง ูุชูุงูู ุจุตูุฑุช ฺฉ ุณุฑูุณ ุฑู ุชุนุฑู ฺฉูู:

```bash
โ kubectl expose pod api-http --type=NodePort --name=api-http --port=8000 --target-port=8000
```

ุชู ุงู ุญุงูุช ุณุฑูุณ ููุท ุจู ฺฉ pod ูุชุตู ูุดูุฏ. ูุชูุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุจุจูู ุงุฏุฑุณ ุงู ุณุฑูุณ ฺ ูุณุชุด:
```bash
โ minikube service api-http --url 
```
ฺฉ ูพูุฑุช ุจู ูุญุฏูุฏู ูพูุฑุชโูุง **30000 ุชุง 32767**  ุณุงุฎุชู ูุดูุฏ. ูุชูุงูู ุงู ููุฑุฏ ุฑู ุฎูุฏููู ูุดุฎุต ฺฉูู ุจุง ุขูพุดู ุฒุฑ ( ุญุชูุง ุจุงุฏ ุจู ูุญุฏูุฏู ูพูุฑุช ูุง ููุฑุฏ ูุธุฑ ุจุงุดู ):

```
--node-port=32500
```

### ุชุณุช ู ุฎุฑูุฌ 
ุญุงูุง ูุง ูุชูุงูู ุจุง ุฏุณุชูุฑ ุฒุฑ ุณุฑูุณ ู pod ููู ุฑู ุชุณุช ฺฉูู ฺฉู ุฏุฑุณุช ฺฉุงุฑ ูฺฉูู ุง ูู:

```bash
 โ curl $(minikube service api-http --url)
 <html>
    <body style="font-family: Arial; text-align: center; padding: 50px;">
        <h1>Hello from Kubernetes! ๐</h1>
        <p>We are running on Pod:</p>
        <h2 style="color: blue;">api-75cccb7b76-78xx8</h2>
        <p>Page Views: Will be added in the next version!</p>
    </body>
</html>
```

### ุญุฐู pod ู ุณุฑูุณ
ุจุง ุฏุณุชูุฑุงุช ุฒุฑ ูุชูุงูู pod ู ุณุฑูุณ ููุฑุฏ ูุธุฑููู ุฑู ุญุฐู ฺฉูู:
```bash
โ kubectl delete pods api
โ kubectl delete service api-http
```

ูฺฉุชู:
ุฒูุงู ฺฉู ูุง pod ุฑู ูพุงฺฉ ูฺฉูู ุณุฑูุณ ุจุงู ููุงูุฏ ู ุงฺฏุฑ ฺฉ pod ุจุง ุงูู ูุดุฎุตุงุช ุงุถุงูู ุดูุฏ ุฏูุจุงุฑู ูุณุฑุงุจ ุงูุฌุงู ูุดูุฏ.
## ุฌูุนโุจูุฏ

ุฎุจ ุชุง ุงูุฌุง ูุง ฺฉ ุณูุฑ ฺฉูฺฺฉ ุชู ุฏูุง ฺฉูุจุฑูุชุฒ ุฏุงุดุชู! ุดุงุฏ ุงููุด ฺฉู ูพฺุฏู ุจู ูุธุฑ ุจุฑุณู ูู ููุช ฺฉุจุงุฑ ุงูุฌุงูุด ุจุฏ ูุจู ฺฉู ุฎู ุณุงุฏูโุชุฑ ุงุฒ ฺุฒู ฺฉู ูฺฉุฑุดู ูโฺฉุฑุฏ.

ูุง ุชู ุงู ุฏุงฺฉูููุช ฺฉ ุจุฑูุงูู Flask ุณุงุฏู ููุดุชู ฺฉู ููุท hostname ุฑู ููุงุด ูุฏู. ุจุนุฏุด ุงูู ุฑู ุฏุงฺฉุฑุงุฒ ฺฉุฑุฏู ู ฺฉ image ุงุฒุด ุณุงุฎุชู. ุจุนุฏ ุงููุฏู ู ุจุง ุงุณุชูุงุฏู ุงุฒ kubectl ุงูู ุฑู ุจุตูุฑุช ฺฉ Pod ุฑู ฺฉูุจุฑูุชุฒ ุจุงูุง ุขูุฑุฏู. ู ุฏุฑ ููุงุช ูู ฺฉ Service ุจุฑุงุด ุชุนุฑู ฺฉุฑุฏู ุชุง ุจุชููู ุงุฒุด ุงุณุชูุงุฏู ฺฉูู.

ูฺฉุชู ููู ุงูู ฺฉู ุงู ุฑูุด ฺฉู ุงูุฌุง ุงุณุชูุงุฏู ฺฉุฑุฏู (ุณุงุฎุช ูุณุชูู Pod) ููุท ุจุฑุง ุชุณุช ู ุงุฏฺฏุฑู! ุชู ูุญุท ูุงูุน ูุง ุงุฒ Deployment ุงุณุชูุงุฏู ูโฺฉูู ฺฉู ุงูฺฉุงูุงุช ุฎู ุจุดุชุฑ ุฏุงุฑู ูุซู scale ฺฉุฑุฏูุ ุจุงุฒฺฏุดุช ุจู ูุณุฎู ูุจูุ ู ูุฏุฑุช ุจูุชุฑ Pod ูุง.

### ุฏุณุชูุฑุงุช

ุจุฑุง ุฑุงุญุช ฺฉุงุฑุ ููู ุฏุณุชูุฑุงุช ฺฉู ุชู ุงู ุฏุงฺฉูููุช ุงุณุชูุงุฏู ฺฉุฑุฏู ุฑู ุงูุฌุง ฺฉุฌุง ุฌูุน ูโฺฉูู:

**ุณุงุฎุช Docker Image:**

```bash
docker build -t hello_app:latest .
```

**ุขูพููุฏ Image ุจู Docker Registry:**

```bash
docker tag hello_app:latest {registry username}/hello_app:latest
docker push {registry username}/hello_app:latest
```

**ุง Load ฺฉุฑุฏู Image ุชู Minikube:**

```bash
minikube image load hello_app:latest
```

**ุณุงุฎุช Pod:**

```bash
kubectl run api --image=hello_app:latest --port=5000 --restart=Never
```

**ูุดุงูุฏู ูุถุนุช Pod ูุง:**

```bash
kubectl get pods
```

**ูุดุงูุฏู ูุงฺฏ ฺฉ Pod:**

```bash
kubectl logs api
```

**ุณุงุฎุช Service:**

```bash
kubectl expose pod api --type=NodePort --name=api-http --port=8000 --target-port=8000
```

**ฺฏุฑูุชู URL ุณุฑูุณ:**

```bash
minikube service api-http --url
```

**ุชุณุช ุณุฑูุณ:**

```bash
curl $(minikube service api-http --url)
```

**ุญุฐู Pod:**

```bash
kubectl delete pod api
```

**ุญุฐู Service:**

```bash
kubectl delete service api-http
```


## ููุงุจุน
Chapter 1 : Kubernetes In Action 